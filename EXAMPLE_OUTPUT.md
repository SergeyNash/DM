# üìä –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ SARIF Parser

–≠—Ç–æ—Ç —Ñ–∞–π–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤—ã–≤–æ–¥ –ø–∞—Ä—Å–µ—Ä–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤–∞—à–∏–º–∏ SARIF —Ñ–∞–π–ª–∞–º–∏.

---

## üß™ –ü—Ä–∏–º–µ—Ä 1: –ó–∞–ø—É—Å–∫ test_parser.py

```
üîç SARIF Parser - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

================================================================================
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: bbs2_ru.sarif
================================================================================

================================================================================
SARIF –û—Ç—á–µ—Ç: PT BlackBox
–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Positive Technologies
================================================================================

–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: 11
–í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª: 6

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏:
  üî¥ –û—à–∏–±–∫–∏ (error):    1
  üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (warning): 1
  üîµ –ó–∞–º–µ—Ç–∫–∏ (note):     9
  ‚ö™ –ü—Ä–æ—á–∏–µ (none):      0

–¢–æ–ø-10 –ø—Ä–∞–≤–∏–ª –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–∞—Ö–æ–¥–æ–∫:
   1. üîµ [   1] –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–¥—Ä–µ—Å–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
      ID: disclosure_email
   2. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-Security-Policy
      ID: missing_content-security-policy
   3. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Feature-Policy
      ID: missing_feature-policy
   4. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Permissions-Policy
      ID: missing_permissions-policy
   5. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Referrer-Policy
      ID: missing_referrer-policy
   6. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-Content-Type-Options
      ID: missing_x-content-type-options
   7. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-Frame-Options
      ID: missing_x-frame-options
   8. üîµ [   1] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-XSS-Protection
      ID: missing_x-xss-protection
   9. üü° [   1] –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
      ID: no_https_scheme
  10. üîµ [   1] –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–æ–ª—è –≤ URL
      ID: password_in_url

================================================================================


üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
  –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö (ERROR): 1
  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (WARNING): 1
  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏: 0

‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —É—Å–ø–µ—à–µ–Ω!
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 2: –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```python
>>> from sarif_parser import SarifParser
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")
>>> 
>>> print(f"–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: {report.tool.name}")
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: PT BlackBox
>>> 
>>> print(f"–ù–∞—Ö–æ–¥–æ–∫: {len(report.findings)}")
–ù–∞—Ö–æ–¥–æ–∫: 67
>>> 
>>> stats = report.get_statistics()
>>> print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: {stats['by_severity']['error']}")
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: 6
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 3: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è SQL Injection

```python
>>> from sarif_parser import SarifParser
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")
>>> 
>>> # –ò—â–µ–º –≤—Å–µ SQL Injection
>>> sqli = [f for f in report.findings if f.rule_id == "sqli"]
>>> 
>>> print(f"SQL Injection: {len(sqli)}")
SQL Injection: 10
>>> 
>>> # –§–∞–π–ª—ã —Å SQL Injection
>>> files = set()
>>> for finding in sqli:
...     for location in finding.locations:
...         files.add(location.file_path)
>>> 
>>> print(f"–£—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤: {len(files)}")
–£—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤: 0
>>> 
>>> # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª–æ
>>> rule = report.rules['sqli']
>>> print(f"–ù–∞–∑–≤–∞–Ω–∏–µ: {rule.name}")
–ù–∞–∑–≤–∞–Ω–∏–µ: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞
>>> print(f"–£—Ä–æ–≤–µ–Ω—å: {rule.level.value}")
–£—Ä–æ–≤–µ–Ω—å: error
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 4: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç—á–µ—Ç—É

```python
>>> from sarif_parser import SarifParser
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\AI3.sarif")
>>> stats = report.get_statistics()
>>> 
>>> print(f"–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: {stats['total_findings']}")
–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: 158
>>> 
>>> print(f"–ü–æ —É—Ä–æ–≤–Ω—è–º:")
–ü–æ —É—Ä–æ–≤–Ω—è–º:
>>> print(f"  –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: {stats['by_severity']['error']}")
  –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: 4
>>> print(f"  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: {stats['by_severity']['warning']}")
  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: 2
>>> print(f"  –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ: {stats['by_severity']['note']}")
  –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ: 152
>>> 
>>> # –¢–æ–ø-5 —Ç–∏–ø–æ–≤ –ø—Ä–æ–±–ª–µ–º
>>> sorted_rules = sorted(stats['by_rule'].items(), 
...                      key=lambda x: x[1]['count'], 
...                      reverse=True)[:5]
>>> 
>>> for rule_id, info in sorted_rules:
...     print(f"  - {info['name']}: {info['count']}")
  - moment 2.29.1: 16
  - moment 2.27.0: 16
  - @babel/traverse 7.9.6: 2
  - node-fetch 2.6.0: 2
  - @babel/helpers 7.12.5: 2
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 5: –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV

```python
>>> import csv
>>> from sarif_parser import SarifParser
>>> 
>>> report = SarifParser.parse_file("report.sarif")
>>> 
>>> with open('export.csv', 'w', newline='', encoding='utf-8') as f:
...     writer = csv.writer(f)
...     writer.writerow(['Rule', 'Severity', 'File', 'Line'])
...     
...     for finding in report.findings:
...         for location in finding.locations:
...             writer.writerow([
...                 finding.rule_name,
...                 finding.level.value,
...                 location.file_path,
...                 location.start_line or ''
...             ])
>>> 
>>> print("‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω: export.csv")
‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω: export.csv
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ CSV:**

```csv
Rule,Severity,File,Line
–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞,error,,
–ú–µ–∂—Å–∞–π—Ç–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤,warning,,
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-Security-Policy,note,,
...
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ print_report_summary()

```python
>>> from sarif_parser import SarifParser, print_report_summary
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")
>>> print_report_summary(report)

================================================================================
SARIF –û—Ç—á–µ—Ç: PT BlackBox
–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Positive Technologies
================================================================================

–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: 67
–í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª: 22

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏:
  üî¥ –û—à–∏–±–∫–∏ (error):    6
  üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (warning): 7
  üîµ –ó–∞–º–µ—Ç–∫–∏ (note):     54
  ‚ö™ –ü—Ä–æ—á–∏–µ (none):      0

–¢–æ–ø-10 –ø—Ä–∞–≤–∏–ª –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–∞—Ö–æ–¥–æ–∫:
   1. üü° [  17] –ú–µ–∂—Å–∞–π—Ç–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
      ID: xss
   2. üî¥ [  10] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞
      ID: sqli
   3. üîµ [   8] –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–± –æ—à–∏–±–∫–µ
      ID: error_message
   4. üîµ [   7] –†–∞—Å–∫—Ä—ã—Ç–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
      ID: fileexposure
   5. üîµ [   6] –õ–∏—Å—Ç–∏–Ω–≥ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
      ID: directory_listing
   6. üü° [   3] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∞
      ID: httpheaderinj
   7. üîµ [   4] –†–∞—Å–∫—Ä—ã—Ç–∏–µ Unix-–ø—É—Ç–µ–π
      ID: unix_path
   8. üîµ [   3] –†–∞—Å–∫—Ä—ã—Ç–∏–µ IP-–∞–¥—Ä–µ—Å–∞
      ID: disclosure_ip
   9. üü° [   2] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ SSI
      ID: ssi
  10. üîµ [   2] –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∞–¥—Ä–µ—Å–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
      ID: disclosure_email

================================================================================
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 7: –†–∞–±–æ—Ç–∞ —Å –ª–æ–∫–∞—Ü–∏—è–º–∏

```python
>>> from sarif_parser import SarifParser
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\AI3.sarif")
>>> 
>>> # –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—É—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –Ω–∞—Ö–æ–¥–∫—É —Å –ª–æ–∫–∞—Ü–∏–µ–π
>>> critical = [f for f in report.findings if f.level.value == 'error']
>>> finding = critical[0]
>>> 
>>> print(f"–£—è–∑–≤–∏–º–æ—Å—Ç—å: {finding.rule_name}")
–£—è–∑–≤–∏–º–æ—Å—Ç—å: node-fetch 2.6.0
>>> 
>>> location = finding.locations[0]
>>> print(f"–§–∞–π–ª: {location.file_path}")
–§–∞–π–ª: ./saltcorn-master/packages/saltcorn-data/models/plugin.js
>>> 
>>> if location.start_line:
...     print(f"–°—Ç—Ä–æ–∫–∞: {location.start_line}")
>>> 
>>> if location.snippet:
...     print(f"–ö–æ–¥:\n{location.snippet}")
–ö–æ–¥:
fetch("http://store.saltcorn.com/api/extensions")
```

---

## üß™ –ü—Ä–∏–º–µ—Ä 8: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM –ø—Ä–æ–µ–∫—Ç–æ–º

```python
>>> from integrate_sarif_to_dm import SecurityReportManager
>>> 
>>> manager = SecurityReportManager(reports_dir="security_reports")
>>> 
>>> # –ò–º–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞
>>> metadata = manager.import_sarif_report(
...     sarif_file_path=r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif",
...     project_name="DM Backend"
... )
üì• –ò–º–ø–æ—Ä—Ç SARIF –æ—Ç—á–µ—Ç–∞...
   –§–∞–π–ª: C:\Users\ssinyakov\Downloads\bbs1_ru.sarif
   –ü—Ä–æ–µ–∫—Ç: DM Backend

‚úÖ –û—Ç—á–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!
   –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: security_reports\report_20251009_143052.json
   –í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: 67
   –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: 6
>>> 
>>> # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –Ω–∞—Ö–æ–¥–æ–∫
>>> findings_file = manager.generate_findings_list(
...     sarif_file_path=r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif",
...     output_format="json"
... )
‚úÖ –°–ø–∏—Å–æ–∫ –Ω–∞—Ö–æ–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: security_reports\findings_20251009_143052.json
   –§–æ—Ä–º–∞—Ç: JSON
   –ó–∞–ø–∏—Å–µ–π: 67
>>> 
>>> # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
>>> dashboard = manager.create_dashboard_summary(
...     sarif_file_path=r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif"
... )
‚úÖ –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: security_reports\dashboard_data.json
>>> 
>>> print(dashboard['summary'])
{'total': 67, 'critical': 6, 'high': 7, 'medium': 54, 'low': 0}
```

---

## üé® –ü—Ä–∏–º–µ—Ä HTML –æ—Ç—á–µ—Ç–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `python example_usage.py` (–ø—Ä–∏–º–µ—Ä 8), —Å–æ–∑–¥–∞–µ—Ç—Å—è HTML —Ñ–∞–π–ª:

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <title>SARIF –û—Ç—á–µ—Ç - PT BlackBox</title>
    <style>
        /* –ö—Ä–∞—Å–∏–≤—ã–µ —Å—Ç–∏–ª–∏ */
    </style>
</head>
<body>
    <div class="container">
        <h1>SARIF –û—Ç—á–µ—Ç: PT BlackBox</h1>
        
        <div class="stats">
            <div class="stat-card">
                <h3>–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫</h3>
                <div class="number">67</div>
            </div>
            <div class="stat-card">
                <h3 class="severity-error">–û—à–∏–±–∫–∏</h3>
                <div class="number severity-error">6</div>
            </div>
            <!-- ... -->
        </div>
        
        <h2>–¢–æ–ø-10 –ø—Ä–∞–≤–∏–ª</h2>
        <table>
            <tr>
                <td>1</td>
                <td>–ú–µ–∂—Å–∞–π—Ç–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</td>
                <td>warning</td>
                <td>17</td>
            </tr>
            <!-- ... -->
        </table>
    </div>
</body>
</html>
```

---

## üìã –ü—Ä–∏–º–µ—Ä —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ CSV

–ü–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ (`example_usage.py`, –ø—Ä–∏–º–µ—Ä 6):

**findings_export.csv:**
```csv
Rule ID,Rule Name,Severity,File,Line,Snippet
sqli,–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞,error,,
xss,–ú–µ–∂—Å–∞–π—Ç–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤,warning,,
missing_content-security-policy,–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-Security-Policy,note,,
file_inclusion,–í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤,error,,
...
```

---

## üìä –ü—Ä–∏–º–µ—Ä JSON —ç–∫—Å–ø–æ—Ä—Ç–∞

–ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (`integrate_sarif_to_dm.py`):

**dashboard_data.json:**
```json
{
  "scan_date": "2025-10-09 14:30:52",
  "tool_name": "PT BlackBox",
  "summary": {
    "total": 67,
    "critical": 6,
    "high": 7,
    "medium": 54,
    "low": 0
  },
  "charts": {
    "severity_distribution": [
      {"name": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ", "value": 6},
      {"name": "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è", "value": 7},
      {"name": "–ó–∞–º–µ—Ç–∫–∏", "value": 54}
    ],
    "top_vulnerabilities": {
      "xss": {
        "count": 17,
        "name": "–ú–µ–∂—Å–∞–π—Ç–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
        "level": "warning"
      },
      "sqli": {
        "count": 10,
        "name": "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞",
        "level": "error"
      }
    }
  },
  "recommendations": [
    {
      "priority": "high",
      "text": "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ!"
    },
    {
      "priority": "high",
      "text": "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 10 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π SQL Injection. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã."
    },
    {
      "priority": "medium",
      "text": "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 17 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π XSS. –≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥."
    }
  ]
}
```

---

## üé® –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

```python
>>> from sarif_parser import SarifParser, SeverityLevel
>>> 
>>> report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")
>>> 
>>> # –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É
>>> print(report.tool)
ToolInfo(PT BlackBox)
>>> 
>>> # –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∞–≤–∏–ª–∞–º
>>> sqli_rule = report.rules['sqli']
>>> print(sqli_rule)
Rule(id='sqli', name='–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞', level=error)
>>> 
>>> # –î–æ—Å—Ç—É–ø –∫ –Ω–∞—Ö–æ–¥–∫–∞–º
>>> finding = report.findings[0]
>>> print(finding)
Finding(rule_id='access_by_ip', level=note, locations=1)
>>> 
>>> # –î–æ—Å—Ç—É–ø –∫ –ª–æ–∫–∞—Ü–∏—è–º
>>> if finding.locations:
...     location = finding.locations[0]
...     print(f"–§–∞–π–ª: {location.file_path}")
...     print(f"–°—Ç—Ä–æ–∫–∞: {location.start_line}")
–§–∞–π–ª: 
–°—Ç—Ä–æ–∫–∞: None
```

---

## üìà –ü—Ä–∏–º–µ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤

```
================================================================================
–ü–†–ò–ú–ï–† 7: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
================================================================================

–û—Ç—á–µ—Ç 1: PT BlackBox
  –ù–∞—Ö–æ–¥–æ–∫: 67

–û—Ç—á–µ—Ç 2: PT BlackBox
  –ù–∞—Ö–æ–¥–æ–∫: 11

–û–±—â–∏–µ —Ç–∏–ø—ã –Ω–∞—Ö–æ–¥–æ–∫: 6
–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–∞ 1: 16
–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–∞ 2: 0
```

---

## üéØ –ü—Ä–∏–º–µ—Ä –¥–ª—è CI/CD

```bash
$ python ci_check.py
üîç –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω
   –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: 6
   –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 7

‚ùå –°–±–æ—Ä–∫–∞ –ø—Ä–æ–≤–∞–ª–µ–Ω–∞: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π!

–°–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:
  1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞ (sqli) - 10 –Ω–∞—Ö–æ–¥–æ–∫
  2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ (rce) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  3. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –û–° (oscmd) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  4. –í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (file_inclusion) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  5. –ß—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (file_read) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  6. –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (fileupload) - 1 –Ω–∞—Ö–æ–¥–∫–∞

$ echo $?
1
```

---

## üåü –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã (–∏–∑ demo.py)

```
üìå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏
--------------------------------------------------------------------------------
üî¥ –û—à–∏–±–∫–∏         [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]    6 (  9.0%)
üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]    7 ( 10.4%)
üîµ –ó–∞–º–µ—Ç–∫–∏        [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà]   54 ( 80.6%)
```

### –¢–∞–±–ª–∏—Ü—ã

```
–¢–æ–ø-10 —Ñ–∞–π–ª–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–±–ª–µ–º:

 1. ./saltcorn-master/packages/server/auth/routes.js
    ‚îî‚îÄ –í—Å–µ–≥–æ: 24 | üî¥ 0 | üü° 0 | üîµ 24
       –¢–∏–ø–æ–≤ –ø—Ä–æ–±–ª–µ–º: 2

 2. ./saltcorn-master/packages/saltcorn-data/base-plugin/types.js
    ‚îî‚îÄ –í—Å–µ–≥–æ: 15 | üî¥ 0 | üü° 0 | üîµ 15
       –¢–∏–ø–æ–≤ –ø—Ä–æ–±–ª–µ–º: 1

 3. ./saltcorn-master/packages/server/routes/list.js
    ‚îî‚îÄ –í—Å–µ–≥–æ: 6 | üî¥ 0 | üü° 0 | üîµ 6
       –¢–∏–ø–æ–≤ –ø—Ä–æ–±–ª–µ–º: 1
```

---

## üíº –†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
"""

from sarif_parser import SarifParser, SeverityLevel
from datetime import datetime
import sys


def daily_security_check(sarif_file):
    """–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
    
    print(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - {datetime.now().strftime('%Y-%m-%d %H:%M')}")
    print(f"üìÇ –û—Ç—á–µ—Ç: {sarif_file}\n")
    
    # –ü–∞—Ä—Å–∏–º –æ—Ç—á–µ—Ç
    report = SarifParser.parse_file(sarif_file)
    stats = report.get_statistics()
    
    # –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   –í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º: {stats['total_findings']}")
    print(f"   üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: {stats['by_severity']['error']}")
    print(f"   üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {stats['by_severity']['warning']}")
    print(f"   üîµ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö: {stats['by_severity']['note']}\n")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
    critical_count = stats['by_severity']['error']
    
    if critical_count > 0:
        print(f"‚ùå –í–ù–ò–ú–ê–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ {critical_count} –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π!\n")
        
        # –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫
        print("–°–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:")
        critical_rules = {}
        for finding in report.findings:
            if finding.level == SeverityLevel.ERROR:
                critical_rules[finding.rule_id] = finding.rule_name
        
        for i, (rule_id, rule_name) in enumerate(critical_rules.items(), 1):
            count = sum(1 for f in report.findings if f.rule_id == rule_id)
            print(f"  {i}. {rule_name} ({rule_id}) - {count} –Ω–∞—Ö–æ–¥–æ–∫")
        
        print("\n‚ö†Ô∏è  –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ!")
        return False
    else:
        print("‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ")
        
        if stats['by_severity']['warning'] > 0:
            print(f"‚ö†Ô∏è  –ï—Å—Ç—å {stats['by_severity']['warning']} –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π")
        
        return True


if __name__ == "__main__":
    sarif_file = sys.argv[1] if len(sys.argv) > 1 else "report.sarif"
    
    success = daily_security_check(sarif_file)
    sys.exit(0 if success else 1)
```

**–í—ã–≤–æ–¥:**

```
üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - 2025-10-09 14:35
üìÇ –û—Ç—á–µ—Ç: bbs1_ru.sarif

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   –í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º: 67
   üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: 6
   üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 7
   üîµ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö: 54

‚ùå –í–ù–ò–ú–ê–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π!

–°–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:
  1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞ (sqli) - 10 –Ω–∞—Ö–æ–¥–æ–∫
  2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ (rce) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  3. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –û–° (oscmd) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  4. –í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (file_inclusion) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  5. –ß—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (file_read) - 1 –Ω–∞—Ö–æ–¥–∫–∞
  6. –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (fileupload) - 1 –Ω–∞—Ö–æ–¥–∫–∞

‚ö†Ô∏è  –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ!
```

---

## üéÅ –í—ã–≤–æ–¥

–ü–∞—Ä—Å–µ—Ä —Å–æ–∑–¥–∞–µ—Ç **—á–∏—Ç–∞–µ–º—ã–π –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –≤—ã–≤–æ–¥** —Å:

- ‚úÖ –¶–≤–µ—Ç–Ω—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (üî¥üü°üîµ)
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏:** `python test_parser.py` üöÄ

