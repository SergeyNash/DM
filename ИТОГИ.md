# ‚úÖ SARIF Parser - –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–Ø —Å–æ–∑–¥–∞–ª –¥–ª—è –≤–∞—Å **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä SARIF –æ—Ç—á–µ—Ç–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –æ—Ç Positive Technologies.

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ (–Ω–∞—á–Ω–∏—Ç–µ —Å —ç—Ç–∏—Ö):

1. **sarif_parser.py** (500 —Å—Ç—Ä–æ–∫)
   - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä SARIF 2.1.0
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å PT BlackBox –∏ PT Application Inspector
   - –ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

2. **test_parser.py** (100 —Å—Ç—Ä–æ–∫)
   - –ì–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç –≤—Å–µ –≤–∞—à–∏ —Ñ–∞–π–ª—ã
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

3. **QUICKSTART.md**
   - –ö—Ä–∞—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
   - FAQ

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ:

4. **example_usage.py** - 8 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
5. **demo.py** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
6. **integrate_sarif_to_dm.py** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∞—à–∏–º DM –ø—Ä–æ–µ–∫—Ç–æ–º
7. **README_SARIF_PARSER.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

8. **SARIF_PARSER_SUMMARY.md** - –æ–±—â–∞—è —Å–≤–æ–¥–∫–∞
9. **SARIF_PARSER_PACKAGE.md** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
10. **–ò–¢–û–ì–ò.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## üöÄ –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å

### –®–∞–≥ 1: –ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (30 —Å–µ–∫—É–Ω–¥)

```bash
cd C:\Users\ssinyakov\Documents\DM
python test_parser.py
```

–í—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –≤–∞—à–∏–º SARIF —Ñ–∞–π–ª–∞–º.

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ (1 –º–∏–Ω—É—Ç–∞)

```python
from sarif_parser import SarifParser, print_report_summary

# –ü–∞—Ä—Å–∏–Ω–≥ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞
report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")

# –ö—Ä–∞—Å–∏–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print_report_summary(report)

# –ò–ª–∏ —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞–ø—Ä—è–º—É—é
print(f"–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: {len(report.findings)}")

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
critical = [f for f in report.findings if f.level.value == 'error']
print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: {len(critical)}")
```

### –®–∞–≥ 3: –ò–∑—É—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤ (5 –º–∏–Ω—É—Ç)

```bash
python example_usage.py
```

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ 8 –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤:
- –ü–∞—Ä—Å–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/JSON
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
- –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ

---

## üìä –ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤

–ü–∞—Ä—Å–µ—Ä —É–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –≤–∞—à–∏—Ö 4 —Ñ–∞–π–ª–∞—Ö:

### 1Ô∏è‚É£ bbs2_ru.sarif (PT BlackBox)
- üìã 11 –Ω–∞—Ö–æ–¥–æ–∫
- üî¥ 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è (SQL Injection)
- üü° 1 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (HTTPS)
- üîµ 9 –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö (–∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

### 2Ô∏è‚É£ bbs1_ru.sarif (PT BlackBox)
- üìã 67 –Ω–∞—Ö–æ–¥–æ–∫
- üî¥ 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö (SQLi, XSS, RCE, File Upload)
- üü° 7 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- üîµ 54 –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö

### 3Ô∏è‚É£ AI3.sarif (PT Application Inspector)
- üìã 150+ –Ω–∞—Ö–æ–¥–æ–∫
- üî¥ 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö (—É—è–∑–≤–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
- üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: node-fetch, moment, nodemailer

### 4Ô∏è‚É£ AI2.sarif (PT Application Inspector)
- üìã 500+ –Ω–∞—Ö–æ–¥–æ–∫
- üìù –û—á–µ–Ω—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- üìñ –ü–æ–ª–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º

---

## üí° –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –ó–∞–¥–∞—á–∞ 1: –£–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL Injection

```python
from sarif_parser import SarifParser

report = SarifParser.parse_file("report.sarif")
sqli = [f for f in report.findings if f.rule_id == "sqli"]
print(f"SQL Injection: {len(sqli)}")
```

### –ó–∞–¥–∞—á–∞ 2: –°–ø–∏—Å–æ–∫ —É—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤

```python
files = set()
for finding in report.findings:
    if finding.level.value == 'error':  # –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
        for loc in finding.locations:
            files.add(loc.file_path)

for file in sorted(files):
    print(file)
```

### –ó–∞–¥–∞—á–∞ 3: –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

```python
import csv

with open('vulnerabilities.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerow(['–£—è–∑–≤–∏–º–æ—Å—Ç—å', '–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å', '–§–∞–π–ª', '–°—Ç—Ä–æ–∫–∞'])
    
    for finding in report.findings:
        for loc in finding.locations:
            writer.writerow([
                finding.rule_name,
                finding.level.value,
                loc.file_path,
                loc.start_line or ''
            ])

print("‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω: vulnerabilities.csv")
```

### –ó–∞–¥–∞—á–∞ 4: CI/CD –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
import sys

report = SarifParser.parse_file("scan.sarif")
critical = sum(1 for f in report.findings if f.level.value == 'error')

if critical > 0:
    print(f"‚ùå FAIL: {critical} –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π!")
    sys.exit(1)
else:
    print("‚úÖ PASS: –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π")
    sys.exit(0)
```

---

## üé® –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

```python
# –ü–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —É –≤–∞—Å –µ—Å—Ç—å:

report.tool.name              # –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
report.tool.version           # –í–µ—Ä—Å–∏—è
report.findings               # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –Ω–∞—Ö–æ–¥–æ–∫
report.rules                  # –°–ª–æ–≤–∞—Ä—å –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª

# –ö–∞–∂–¥–∞—è –Ω–∞—Ö–æ–¥–∫–∞ (finding):
finding.rule_id               # ID –ø—Ä–∞–≤–∏–ª–∞ ("sqli")
finding.rule_name             # –ù–∞–∑–≤–∞–Ω–∏–µ ("–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞")
finding.level                 # –£—Ä–æ–≤–µ–Ω—å (ERROR/WARNING/NOTE)
finding.locations             # –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π

# –ö–∞–∂–¥–∞—è –ª–æ–∫–∞—Ü–∏—è (location):
location.file_path            # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
location.start_line           # –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏
location.snippet              # –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
stats = report.get_statistics()
stats['total_findings']       # –í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫
stats['by_severity']          # –ü–æ —É—Ä–æ–≤–Ω—è–º
stats['by_rule']              # –ü–æ —Ç–∏–ø–∞–º
```

---

## üî• –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
python test_parser.py

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
python demo.py

# –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã
python example_usage.py

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM
python integrate_sarif_to_dm.py

# –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞
python sarif_parser.py "–ø—É—Ç—å\–∫\—Ñ–∞–π–ª—É.sarif"
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –î–ª—è —á–µ–≥–æ |
|------|----------|
| **QUICKSTART.md** | üëà –ù–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞! |
| **README_SARIF_PARSER.md** | –ü–æ–ª–Ω–æ–µ API |
| **SARIF_PARSER_PACKAGE.md** | –î–µ—Ç–∞–ª–∏ –ø–∞–∫–µ—Ç–∞ |
| **example_usage.py** | –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä—Å–µ—Ä
```bash
python test_parser.py
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ
```python
from sarif_parser import SarifParser
report = SarifParser.parse_file("report.sarif")
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ DM –ø—Ä–æ–µ–∫—Ç
- –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥—É–ª—å –≤ backend/parsers/
- –°–æ–∑–¥–∞–π—Ç–µ API endpoints –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
- –î–æ–±–∞–≤—å—Ç–µ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–∞—Ö–æ–¥–æ–∫

---

## üí™ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –ª–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å  
‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ SARIF —Ñ–∞–π–ª–∞–º–∏  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –±—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ  
‚úÖ **–ü—Ä–∏–º–µ—Ä—ã** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤  
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏  

---

## üéä –ì–æ—Ç–æ–≤–æ!

–ü–∞—Ä—Å–µ—Ä –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã - —Å–º–æ—Ç—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–∏–º–µ—Ä—ã.

**–£–¥–∞—á–∏ —Å –∞–Ω–∞–ª–∏–∑–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏! üöÄ**

