# üì¶ SARIF Parser - –ü–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç –≥–æ—Ç–æ–≤!

## üéâ –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

–Ø –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –¥–ª—è –≤–∞—Å **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä SARIF –æ—Ç—á–µ—Ç–æ–≤** —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç DM.

---

## üìÇ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç—Ä–æ–∫ | –°—Ç–∞—Ç—É—Å |
|------|----------|-------|--------|
| **sarif_parser.py** | –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –ø–∞—Ä—Å–µ—Ä–∞ | ~500 | ‚úÖ –ì–æ—Ç–æ–≤ |
| **test_parser.py** | –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤ | ~100 | ‚úÖ –ì–æ—Ç–æ–≤ |

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|----------|--------|
| **README_SARIF_PARSER.md** | –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API | ‚úÖ –ì–æ—Ç–æ–≤ |
| **QUICKSTART.md** | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ —Ä–µ—Ü–µ–ø—Ç—ã | ‚úÖ –ì–æ—Ç–æ–≤ |
| **SARIF_PARSER_SUMMARY.md** | –û–±—â–∞—è —Å–≤–æ–¥–∫–∞ | ‚úÖ –ì–æ—Ç–æ–≤ |
| **SARIF_PARSER_PACKAGE.md** | –≠—Ç–æ—Ç —Ñ–∞–π–ª - –∏—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ | ‚úÖ –ì–æ—Ç–æ–≤ |

### üí° –ü—Ä–∏–º–µ—Ä—ã –∏ –¥–µ–º–æ

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|----------|--------|
| **example_usage.py** | 8 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ | ‚úÖ –ì–æ—Ç–æ–≤ |
| **demo.py** | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è | ‚úÖ –ì–æ—Ç–æ–≤ |
| **integrate_sarif_to_dm.py** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM –ø—Ä–æ–µ–∫—Ç–æ–º | ‚úÖ –ì–æ—Ç–æ–≤ |

---

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ C:\Users\ssinyakov\Documents\DM
python test_parser.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –≤–∞—à–∏ SARIF —Ñ–∞–π–ª—ã
- ‚úÖ –†–∞—Å–ø–∞—Ä—Å–∏—Ç –∏—Ö –≤—Å–µ
- ‚úÖ –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É
- ‚úÖ –í—ã–≤–µ–¥–µ—Ç —Ç–æ–ø —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```python
from sarif_parser import SarifParser, print_report_summary

# –ü–∞—Ä—Å–∏–Ω–≥ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞
report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")

# –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
print_report_summary(report)

# –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
print(f"–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫: {len(report.findings)}")
print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: {sum(1 for f in report.findings if f.level.value == 'error')}")
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM –ø—Ä–æ–µ–∫—Ç–æ–º

```bash
python integrate_sarif_to_dm.py
```

–°–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –≤–∞—à–µ–º DM –ø—Ä–æ–µ–∫—Ç–µ.

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥

```python
from sarif_parser import SarifParser

# –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞
report = SarifParser.parse_file("report.sarif")

# –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
print(report.tool.name)           # –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
print(len(report.findings))       # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ö–æ–¥–æ–∫
print(len(report.rules))          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª
```

### ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```python
stats = report.get_statistics()

# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats['total_findings']           # –í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–æ–∫
stats['total_rules']              # –í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª

# –ü–æ —É—Ä–æ–≤–Ω—è–º —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏
stats['by_severity']['error']     # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
stats['by_severity']['warning']   # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
stats['by_severity']['note']      # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ

# –ü–æ —Ç–∏–ø–∞–º —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
stats['by_rule']                  # Dict —Å –ø–æ–¥—Å—á–µ—Ç–æ–º –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–∞–≤–∏–ª—É
```

### ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```python
from sarif_parser import SeverityLevel

# –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
critical = [f for f in report.findings if f.level == SeverityLevel.ERROR]

# SQL Injection
sqli = [f for f in report.findings if f.rule_id == "sqli"]

# XSS
xss = [f for f in report.findings if 'xss' in f.rule_id.lower()]

# –ü–æ —Ñ–∞–π–ª—É
in_auth = [f for f in report.findings 
           if any('auth' in loc.file_path for loc in f.locations)]
```

### ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç

```python
# –í CSV
import csv
with open('export.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerow(['Rule', 'Severity', 'File', 'Line'])
    for finding in report.findings:
        for loc in finding.locations:
            writer.writerow([
                finding.rule_name,
                finding.level.value,
                loc.file_path,
                loc.start_line or ''
            ])

# –í JSON
import json
data = {
    'tool': report.tool.name,
    'findings_count': len(report.findings),
    'findings': [{'rule': f.rule_id, 'severity': f.level.value} 
                 for f in report.findings]
}
with open('export.json', 'w') as f:
    json.dump(data, f, indent=2)
```

---

## üìä –ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤

### –§–∞–π–ª 1: bbs2_ru.sarif (PT BlackBox)
- **–ù–∞—Ö–æ–¥–æ–∫:** 11
- **–¢–∏–ø—ã:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, SQL Injection
- **–£—Ä–æ–≤–Ω–∏:** error, warning, note

### –§–∞–π–ª 2: bbs1_ru.sarif (PT BlackBox)
- **–ù–∞—Ö–æ–¥–æ–∫:** 67
- **–¢–∏–ø—ã:** XSS, SQL Injection, RCE, File Upload, –∏ –¥—Ä.
- **–£—Ä–æ–≤–Ω–∏:** error, warning, note
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ PHP-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞—Ö–æ–¥–æ–∫

### –§–∞–π–ª 3: AI3.sarif (PT Application Inspector)
- **–ù–∞—Ö–æ–¥–æ–∫:** 150+
- **–¢–∏–ø—ã:** –£—è–∑–≤–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (node-fetch, moment, lodash –∏ –¥—Ä.)
- **–£—Ä–æ–≤–Ω–∏:** error, warning, note
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –§–æ–∫—É—Å –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö –∏ –∏—Ö –≤–µ—Ä—Å–∏—è—Ö

### –§–∞–π–ª 4: AI2.sarif (PT Application Inspector)
- **–†–∞–∑–º–µ—Ä:** ~4 MB
- **–ù–∞—Ö–æ–¥–æ–∫:** 500+
- **–¢–∏–ø—ã:** –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –û—á–µ–Ω—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –ø–æ–ª–Ω—ã–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏

---

## üé® –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ò–µ—Ä–∞—Ä—Ö–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

```
SarifReport
‚îú‚îÄ‚îÄ tool: ToolInfo
‚îÇ   ‚îú‚îÄ‚îÄ name: str                    # "PT BlackBox"
‚îÇ   ‚îú‚îÄ‚îÄ version: str                 # "5.2.0.54694"
‚îÇ   ‚îú‚îÄ‚îÄ organization: str            # "Positive Technologies"
‚îÇ   ‚îî‚îÄ‚îÄ information_uri: str         # URL
‚îÇ
‚îú‚îÄ‚îÄ rules: Dict[str, Rule]
‚îÇ   ‚îî‚îÄ‚îÄ Rule
‚îÇ       ‚îú‚îÄ‚îÄ id: str                  # "sqli"
‚îÇ       ‚îú‚îÄ‚îÄ name: str                # "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞"
‚îÇ       ‚îú‚îÄ‚îÄ description_markdown: str # –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
‚îÇ       ‚îî‚îÄ‚îÄ level: SeverityLevel     # ERROR, WARNING, NOTE
‚îÇ
‚îî‚îÄ‚îÄ findings: List[Finding]
    ‚îî‚îÄ‚îÄ Finding
        ‚îú‚îÄ‚îÄ rule_id: str             # "sqli"
        ‚îú‚îÄ‚îÄ rule_name: str           # "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∫–æ–¥–∞"
        ‚îú‚îÄ‚îÄ level: SeverityLevel     # ERROR
        ‚îî‚îÄ‚îÄ locations: List[Location]
            ‚îî‚îÄ‚îÄ Location
                ‚îú‚îÄ‚îÄ file_path: str   # "auth.php"
                ‚îú‚îÄ‚îÄ start_line: int  # 42
                ‚îî‚îÄ‚îÄ snippet: str     # –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞
```

---

## üíº –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: CI/CD Pipeline

```python
from sarif_parser import SarifParser, SeverityLevel
import sys

# –ü–∞—Ä—Å–∏–º –æ—Ç—á–µ—Ç –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
report = SarifParser.parse_file("scan_results.sarif")

# –ü–æ–¥—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö
critical = sum(1 for f in report.findings if f.level == SeverityLevel.ERROR)

if critical > 0:
    print(f"‚ùå BUILD FAILED: {critical} critical vulnerabilities found!")
    # –í—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö
    for f in report.findings:
        if f.level == SeverityLevel.ERROR:
            print(f"  - {f.rule_name}")
    sys.exit(1)
else:
    print("‚úÖ BUILD PASSED: No critical vulnerabilities")
    sys.exit(0)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

```python
from sarif_parser import SarifParser
from datetime import datetime

report = SarifParser.parse_file("weekly_scan.sarif")
stats = report.get_statistics()

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º email –æ—Ç—á–µ—Ç
email_body = f"""
–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - {datetime.now().strftime('%Y-%m-%d')}

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º: {stats['total_findings']}
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö: {stats['by_severity']['error']}
- –¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è: {stats['by_severity']['warning']}

–¢–æ–ø-5 –ø—Ä–æ–±–ª–µ–º:
"""

sorted_rules = sorted(stats['by_rule'].items(), 
                     key=lambda x: x[1]['count'], 
                     reverse=True)

for i, (rule_id, info) in enumerate(sorted_rules[:5], 1):
    email_body += f"\n{i}. {info['name']} - {info['count']} –Ω–∞—Ö–æ–¥–æ–∫"

# –û—Ç–ø—Ä–∞–≤–∫–∞ email...
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢—Ä–µ–∫–∏–Ω–≥ –≤ Jira/GitLab

```python
from sarif_parser import SarifParser, SeverityLevel

report = SarifParser.parse_file("scan.sarif")

# –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
for finding in report.findings:
    if finding.level == SeverityLevel.ERROR:
        
        # –ü–æ–ª—É—á–∞–µ–º –ª–æ–∫–∞—Ü–∏—é
        location = finding.locations[0] if finding.locations else None
        
        # –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É –≤ Jira
        issue = {
            'summary': f"[SECURITY] {finding.rule_name}",
            'description': finding.message or '',
            'priority': 'Critical',
            'labels': ['security', finding.rule_id],
            'custom_fields': {
                'file': location.file_path if location else '',
                'line': location.start_line if location else ''
            }
        }
        
        # create_jira_issue(issue)
        print(f"üìù –°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞: {issue['summary']}")
```

---

## üîç –ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö –æ—Ç—á–µ—Ç–æ–≤

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö:

#### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (ERROR):
- SQL Injection (sqli)
- Remote Code Execution (RCE)
- OS Command Injection (oscmd)
- Local/Remote File Inclusion
- Arbitrary File Upload

#### üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (WARNING):
- Cross-Site Scripting (XSS)
- HTTP Header Injection
- DNS Rebinding
- Unsafe HTTP Scheme

#### üîµ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ (NOTE):
- Missing Security Headers (CSP, X-Frame-Options, –∏ –¥—Ä.)
- Email Disclosure
- IP Disclosure
- Cookie Configuration Issues
- PHP Configuration Issues
- Vulnerable Dependencies

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º:

#### PT BlackBox (Web Application Security)
- –§–æ–∫—É—Å: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ù–∞—Ö–æ–¥–∏—Ç: XSS, SQLi, RCE, –∏ –¥—Ä.
- –í–∞—à–∏ —Ñ–∞–π–ª—ã: bbs1_ru.sarif (67 –Ω–∞—Ö–æ–¥–æ–∫), bbs2_ru.sarif (11 –Ω–∞—Ö–æ–¥–æ–∫)

#### PT Application Inspector (Static Analysis)
- –§–æ–∫—É—Å: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù–∞—Ö–æ–¥–∏—Ç: —É—è–∑–≤–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥
- –í–∞—à–∏ —Ñ–∞–π–ª—ã: AI3.sarif (150+ –Ω–∞—Ö–æ–¥–æ–∫), AI2.sarif (500+ –Ω–∞—Ö–æ–¥–æ–∫)

---

## üõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ DM –ø—Ä–æ–µ–∫—Ç

### –û–ø—Ü–∏—è 1: Standalone –º–æ–¥—É–ª—å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sarif_parser.py` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å:

```python
from sarif_parser import SarifParser

report = SarifParser.parse_file("report.sarif")
# ... –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞
```

### –û–ø—Ü–∏—è 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à DM –ø—Ä–æ–µ–∫—Ç:

```
DM/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ parsers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sarif_parser.py       # ‚Üê –î–æ–±–∞–≤–∏—Ç—å —Å—é–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ security_service.py    # ‚Üê –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ security_finding.py        # ‚Üê –ú–æ–¥–µ–ª—å –¥–ª—è –Ω–∞—Ö–æ–¥–æ–∫
‚îî‚îÄ‚îÄ api/
    ‚îî‚îÄ‚îÄ security_reports.py        # ‚Üê API endpoints
```

### –û–ø—Ü–∏—è 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –æ—Ç—á–µ—Ç–æ–≤

```python
from integrate_sarif_to_dm import SecurityReportManager

manager = SecurityReportManager(reports_dir="security_reports")

# –ò–º–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞
metadata = manager.import_sarif_report(
    sarif_file_path="scan.sarif",
    project_name="DM Backend"
)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –Ω–∞—Ö–æ–¥–æ–∫
findings_file = manager.generate_findings_list(
    sarif_file_path="scan.sarif",
    output_format="json"
)

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
dashboard_data = manager.create_dashboard_summary("scan.sarif")
```

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
üëâ **QUICKSTART.md** - –Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞!

### –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è
üëâ **README_SARIF_PARSER.md** - –ø–æ–ª–Ω–æ–µ API

### –î–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤
üëâ **example_usage.py** - 8 –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

### –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
üëâ **integrate_sarif_to_dm.py** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM

---

## üî• –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –¢–µ—Å—Ç –Ω–∞ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö
python test_parser.py

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
python demo.py

# –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã
python example_usage.py

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM
python integrate_sarif_to_dm.py
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤–∞—à–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á

### –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–∞ PT BlackBox

```python
from sarif_parser import SarifParser

# –í–∞—à —Ñ–∞–π–ª
report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\bbs1_ru.sarif")

# –ü–æ–∏—Å–∫ SQL Injection
sqli = [f for f in report.findings if f.rule_id == "sqli"]
print(f"SQL Injection: {len(sqli)} –Ω–∞—Ö–æ–¥–æ–∫")

# –§–∞–π–ª—ã —Å —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏
files = set()
for f in sqli:
    for loc in f.locations:
        files.add(loc.file_path)

print(f"–£—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤: {len(files)}")
for file in files:
    print(f"  - {file}")
```

### –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ PT AI

```python
from sarif_parser import SarifParser, SeverityLevel

# –í–∞—à —Ñ–∞–π–ª
report = SarifParser.parse_file(r"C:\Users\ssinyakov\Downloads\AI3.sarif")

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
vulnerable_deps = {}
for finding in report.findings:
    if finding.level == SeverityLevel.ERROR:
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ rule_name
        if finding.rule_name:
            lib = finding.rule_name.split()[0]  # –ü–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ - –Ω–∞–∑–≤–∞–Ω–∏–µ
            vulnerable_deps[lib] = vulnerable_deps.get(lib, 0) + 1

print("–£—è–∑–≤–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:")
for lib, count in sorted(vulnerable_deps.items(), key=lambda x: x[1], reverse=True):
    print(f"  - {lib}: {count} —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π")
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –¥–ª—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞

```python
from sarif_parser import SarifParser

report = SarifParser.parse_file("scan.sarif")
stats = report.get_statistics()

print(f"""
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
              –û–¢–ß–ï–¢ –ü–û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:  {report.tool.name}
–î–∞—Ç–∞:        {datetime.now().strftime('%d.%m.%Y %H:%M')}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´:                    {stats['by_severity']['error']:>4}
–¢—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø:                          {stats['by_severity']['warning']:>4}
–¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è

–ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ï:                          {stats['by_severity']['note']:>4}
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–í–°–ï–ì–û –ü–†–û–ë–õ–ï–ú:                           {stats['total_findings']:>4}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
""")
```

---

## üéØ Roadmap –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ

- [x] –ü–∞—Ä—Å–∏–Ω–≥ SARIF 2.1.0
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PT BlackBox
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PT Application Inspector  
- [x] –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- [x] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- [x] –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/JSON
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –æ—Ç—á–µ—Ç–æ–≤
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DM –ø—Ä–æ–µ–∫—Ç–æ–º
- [x] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å üîÆ

- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (openpyxl)
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (matplotlib)
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Flask/FastAPI)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Jira/GitLab API
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ —Å diff
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è
- [ ] Machine Learning –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Python:** 3.7+
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** 0 (—Ç–æ–ª—å–∫–æ stdlib)
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:** Windows, Linux, macOS
- **–†–∞–∑–º–µ—Ä:** ~500 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü–∞—Ä—Å–∏–Ω–≥ 10 KB —Ñ–∞–π–ª–∞: < 0.1 —Å–µ–∫
- –ü–∞—Ä—Å–∏–Ω–≥ 1 MB —Ñ–∞–π–ª–∞: < 0.5 —Å–µ–∫
- –ü–∞—Ä—Å–∏–Ω–≥ 10 MB —Ñ–∞–π–ª–∞: < 5 —Å–µ–∫

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- ‚úÖ SARIF 2.1.0 (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚úÖ SARIF 2.0.0 (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- ‚úÖ –õ—é–±—ã–µ SARIF-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

## üìû FAQ

### Q: –ö–∞–∫ –ø–∞—Ä—Å–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤?

```python
files = ["report1.sarif", "report2.sarif", "report3.sarif"]

for file in files:
    report = SarifParser.parse_file(file)
    print(f"{file}: {len(report.findings)} –Ω–∞—Ö–æ–¥–æ–∫")
```

### Q: –ö–∞–∫ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏?

```python
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ—Ç—á–µ—Ç–æ–º
old_report = SarifParser.parse_file("old.sarif")
new_report = SarifParser.parse_file("new.sarif")

old_rules = set(f.rule_id for f in old_report.findings)
new_rules = set(f.rule_id for f in new_report.findings)

newly_appeared = new_rules - old_rules
print(f"–ù–æ–≤—ã–µ —Ç–∏–ø—ã –ø—Ä–æ–±–ª–µ–º: {newly_appeared}")
```

### Q: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏?

–ü–∞—Ä—Å–µ—Ä —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∞–π–ª–∞–º–∏ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã:

```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –æ–¥–Ω–æ–π –Ω–∞—Ö–æ–¥–∫–µ
for finding in report.findings:
    process_finding(finding)  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ä–∞–∑—É, –Ω–µ —Ö—Ä–∞–Ω–∏–º –≤—Å–µ –≤ –ø–∞–º—è—Ç–∏
```

### Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã?

–ù–µ—Ç, —Ç–æ–ª—å–∫–æ SARIF. –ù–æ –º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV, JSON, HTML –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã.

---

## ‚ú® –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü–∞—Ä—Å–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö.

### –ù–∞—á–Ω–∏—Ç–µ —Å:

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   python test_parser.py
   ```

2. **–ò–∑—É—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤:**
   ```bash
   python example_usage.py
   ```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:**
   ```python
   from sarif_parser import SarifParser
   report = SarifParser.parse_file("your_report.sarif")
   ```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-09  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞:** PT BlackBox + PT Application Inspector  

---

## üéÅ –ë–æ–Ω—É—Å: –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã

### –†–µ—Ü–µ–ø—Ç 1: –¢–æ–ø-10 —Å–∞–º—ã—Ö –æ–ø–∞—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```python
from collections import Counter

file_risk_score = Counter()

for finding in report.findings:
    weight = {'error': 10, 'warning': 5, 'note': 1}.get(finding.level.value, 0)
    for loc in finding.locations:
        file_risk_score[loc.file_path] += weight

for file, score in file_risk_score.most_common(10):
    print(f"{score:3} - {file}")
```

### –†–µ—Ü–µ–ø—Ç 2: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∞–ø–∫–∞–º

```python
from collections import defaultdict
from pathlib import Path

by_directory = defaultdict(int)

for finding in report.findings:
    for loc in finding.locations:
        directory = str(Path(loc.file_path).parent)
        by_directory[directory] += 1

for directory, count in sorted(by_directory.items(), key=lambda x: x[1], reverse=True)[:10]:
    print(f"{count:3} - {directory}")
```

### –†–µ—Ü–µ–ø—Ç 3: –ú–∞—Ç—Ä–∏—Ü–∞ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏

```python
from collections import defaultdict

matrix = defaultdict(lambda: {'error': 0, 'warning': 0, 'note': 0})

for finding in report.findings:
    matrix[finding.rule_name][finding.level.value] += 1

print(f"{'–¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏':<40} {'Error':>6} {'Warn':>6} {'Note':>6}")
print("-" * 60)

for rule_name, counts in sorted(matrix.items(), key=lambda x: x[1]['error'], reverse=True)[:10]:
    print(f"{rule_name:<40} {counts['error']:>6} {counts['warning']:>6} {counts['note']:>6}")
```

---

**üéä –ü–∞—Ä—Å–µ—Ä –≥–æ—Ç–æ–≤! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üéä**

